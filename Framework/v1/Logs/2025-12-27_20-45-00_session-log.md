# Session Log: 2025-12-27 (Session 9)

## Overview

This session focused on adding BillboardGui HUD displays for the Dispenser and TimedEvaluator assets. The Dispenser shows remaining count with a marshmallow icon, and the TimedEvaluator shows satisfaction level via emoji and target toast preference via a 3D marshmallow preview.

---

## 1. Dispenser BillboardGui

### Initial Approach (Failed)

Attempted to use `.rbxm` export for BillboardGui - exported from Studio and placed in `StarterGui/BillboardGui.rbxm`. The BillboardGui was found by the script but never rendered visually. Tried various property adjustments (Size, StudsOffset, AlwaysOnTop, MaxDistance) with no success.

### Solution: Code-Based GUI

Switched to creating the BillboardGui entirely via code in the LocalScript. This approach worked immediately and enabled faster iteration on styling.

### Final Implementation

**Structure:**
```
Dispenser/
‚îú‚îÄ‚îÄ StarterGui/
‚îÇ   ‚îî‚îÄ‚îÄ LocalScript.client.lua  # Creates BillboardGui, updates count
```

**Display Elements:**
- Marshmallow icon (ImageLabel) - uploaded as `rbxassetid://97382091340704`
- "x" label (TextLabel)
- Count label (TextLabel) - updates from `Remaining` attribute

**Styling:**
- Rounded corners (UICorner, 10px radius)
- White background, 80% transparency
- Orange/gold text color (255, 170, 0)
- GothamBold font, 28pt
- UIListLayout with LayoutOrder for element positioning

**Key Pattern:**
```lua
-- Listen for attribute changes
model:GetAttributeChangedSignal("Remaining"):Connect(updateDisplay)
```

---

## 2. TimedEvaluator Satisfaction System

### Server-Side Changes

Added satisfaction tracking to `TimedEvaluator.Script`:

1. **TimerTick BindableEvent** - fires every timer cycle with state data
2. **updateSatisfaction()** - decreases satisfaction over time
3. **Satisfaction attribute** - starts at 100, decays by `deltaTime * 3` per tick

```lua
timerTick:Fire({
    deltaTime = dt,
    timeRemaining = timeRemaining,
    countdown = countdown,
})
```

### Client-Side HUD

**Emoji Stages** (satisfaction level):
| Range | Emoji |
|-------|-------|
| 80-100 | üòÄ Grinning |
| 60-79 | üôÇ Smiling |
| 40-59 | üòê Meh |
| 20-39 | üò¢ Sad |
| 0-19 | üò† Angry |

**Toast Preview (ViewportFrame):**
- Clones the Marshmallow Handle from Templates
- Displays in a ViewportFrame with custom Camera
- Isometric camera angle: `CFrame.new(Vector3.new(0.8, 0.6, 0.8), Vector3.new(0, 0, 0))`
- Color interpolates based on TargetValue:
  - 0-50: raw (off-white) ‚Üí golden
  - 50-100: golden ‚Üí burnt (dark brown)
- PointLight added for visibility

**BillboardGui Properties:**
- Size: `UDim2.new(2.5, 0, 1.25, 0)` (studs, scales with distance)
- StudsOffset: `Vector3.new(0, 5.5, 0)`
- AlwaysOnTop: true

---

## 3. Marshmallow Template Handle

Created `Handle.rbxm` for the Marshmallow Tool template:
- Required for Tool to function (attaches to player's hand)
- Used by TimedEvaluator ViewportFrame preview
- Exported from Studio to `src/Templates/Marshmallow/Handle.rbxm`

---

## 4. Configuration Changes

### TimedEvaluator Target Range

Widened default target range for more visual variation:
- Previous: 30-100
- New: 10-100

---

## 5. Design Patterns Established

### Code-Based GUI for BillboardGui

When `.rbxm` export fails or iteration speed matters, create GUI elements in code:
- Faster iteration (no export/sync cycle)
- Easier property adjustment
- Avoids mysterious rendering issues

### ViewportFrame for 3D Previews

Display 3D models in UI using ViewportFrame:
1. Clone the model/part
2. Position at origin
3. Create Camera pointing at it
4. Add PointLight for visibility
5. Parent to ViewportFrame

### Attribute-Driven Updates

Use `GetAttributeChangedSignal()` for reactive UI updates:
```lua
model:GetAttributeChangedSignal("Satisfaction"):Connect(updateDisplay)
```

---

## 6. Files Changed

### New Files

```
src/Assets/Dispenser/StarterGui/
‚îî‚îÄ‚îÄ LocalScript.client.lua

src/Assets/TimedEvaluator/StarterGui/
‚îî‚îÄ‚îÄ LocalScript.client.lua

src/Templates/Marshmallow/
‚îî‚îÄ‚îÄ Handle.rbxm
```

### Modified Files

- `src/Assets/TimedEvaluator/ServerScriptService/Script.server.lua`
  - Added TimerTick BindableEvent
  - Added updateSatisfaction() with decay logic
  - Added Satisfaction attribute initialization
  - Widened default target range (10-100)

---

## 7. Current Asset HUD Summary

| Asset | HUD Type | Displays |
|-------|----------|----------|
| Dispenser | BillboardGui | Icon + "x" + remaining count |
| TimedEvaluator | BillboardGui | Marshmallow preview + satisfaction emoji |
| Scoreboard | ScreenGui | Score value |
| GlobalTimer | ScreenGui | Round countdown |
| LeaderBoard | SurfaceGui | Top 10 scores (in-world) |

---

## 8. Attempted but Removed

### Satisfaction Border

Attempted to add a colored border around TimedEvaluator HUD that transitions green ‚Üí yellow ‚Üí red with satisfaction. Caused layout issues with emoji positioning. Removed to avoid scope creep.

---

## 9. Next Steps

1. RoastingStick tool implementation
2. Visual feedback for marshmallow cooking (color change on actual marshmallow)
3. Handle.rbxm styling (actual marshmallow shape vs placeholder)
4. End-of-round summary screen
